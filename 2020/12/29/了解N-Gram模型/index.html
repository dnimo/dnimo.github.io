<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>
        Masano
    </title>
    
<link rel="stylesheet" href="/libs/highlight/styles/monokai-sublime.css">

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.3.0"></head>

<body id="bodyx">
    <div class="hd posts">
    <a href="/index.html"><i class="fa fa-reply replay-btn" aria-hidden="true"></i></a>
    <div class="post-title">
        <p>
            了解N-Gram模型
        </p>
        <hr>
    </div>
    <div class="post-content">
        <h4 id="关于语言模型"><a href="#关于语言模型" class="headerlink" title="关于语言模型"></a>关于语言模型</h4><blockquote>
<p>语言模型就是用来计算一个句子的概率的模型，也就是判断一句话是否合理的概率</p>
<p>一开始，都是基于规则的语言模型研究，但这样往往有很大的问题，后来发明了基于统计的语言模型</p>
<p>N-gram就是统计语言模型的一种，其他的还有RNN以及LSTM</p>
</blockquote>
<h4 id="N-Gram详解"><a href="#N-Gram详解" class="headerlink" title="N-Gram详解"></a>N-Gram详解</h4><p>基于统计概率来说，我们需要计算句子的概率大小：$P(S)=P(\omega_1,\omega_2,\cdot\cdot\cdot,\omega_n)$ ，这个就是最终要求的一句话的概率，概率大说明更合理，概率小说明不合理</p>
<p>因为是不能直接计算的，所以我们要应用条件概率得到：</p>
<p>$P(\omega_1,\omega_2,\cdot\cdot\cdot,\omega_n)=P(\omega_1)*P(\omega_2|\omega_1)*P(\omega_3|\omega_1,\omega_2)\cdot\cdot\cdot P(\omega_n|\omega1,\cdot\cdot\cdot,\omega_{n-1})$ </p>
<p>中间插入条件概率：P(B|A)：A条件下B发生的概率。从一个大的空间进入到一个字空间（切片），计算在子空间中的占比</p>
<p>$P(B|A)=\frac{P(A,B)}{P(A)}$  </p>
<p>然而，如果直接计算条件概率转化后的式子的话，对每个词要考虑它前面的所有词，这在实际中意义不大，而且不好计算。这个时候我们要基于马尔科夫假设来做简化</p>
<h4 id="马尔科夫假设"><a href="#马尔科夫假设" class="headerlink" title="马尔科夫假设"></a>马尔科夫假设</h4><blockquote>
<p>马尔可夫假设是指，每个词出现的概率只跟它前面的少数几个词有关，例如，二阶马尔可夫假设只考虑前面的两个词，相应的语言模型是三元模型。引入马尔科夫假设的语言模型，也叫做马尔科夫模型。</p>
<p>马尔可夫链为状态空间中经过从一个状态到另一状态的转换的随机 过程。该过程要求具备“无记忆”的性质：下一个状态的概率分布只能由当前状态决定，在时间序列中它前面的事件均与之无关</p>
</blockquote>
<p>要就是说，应用了这个假设表明了当前这个词仅仅跟前面几个有限词相关，因此也就不必追溯到最开始的那个词，这样便可以大幅度缩减上述的算式长度</p>
<p>$P(\omega_1,\omega_2,\cdots,\omega_n)=P(\omega_i|\omega_{i-m+1},\cdots,\omega_{i-1})$ </p>
<blockquote>
<p>这里的m表示前m个词相关</p>
</blockquote>
<p>然后我们可以设置m=1,2,3,….得到相应的一元模型，二元模型，三元模型</p>
<p>而N-Gram模型也就是这样，当m=1，叫1-gram或者unigram；m=2，叫2-gram或者bigram</p>
<h4 id="利用N-Gram模型评估语句是否合理"><a href="#利用N-Gram模型评估语句是否合理" class="headerlink" title="利用N-Gram模型评估语句是否合理"></a>利用N-Gram模型评估语句是否合理</h4><p>假设现在有一个语料库，我们统计了下面的一些词出现的数量</p>
<table>
<thead>
<tr>
<th>i</th>
<th>want</th>
<th>to</th>
<th>eat</th>
<th>chinese</th>
<th>food</th>
<th>lunch</th>
<th>spend</th>
</tr>
</thead>
<tbody><tr>
<td>2533</td>
<td>927</td>
<td>2417</td>
<td>746</td>
<td>158</td>
<td>1093</td>
<td>341</td>
<td>278</td>
</tr>
</tbody></table>
<p>下面的这些概率作为已知条件：</p>
<p>$P(i|<s>)=0.25 \hspace{2cm} P(english|want)=0.0011$ </p>
<p>$P(food|english)=0.5 \hspace{2cm} P(</s>|food)=0.68$</p>
<p>$P(want|<s>)=0.25$</p>
<p>下面这个表给出了基于bigram模型进行计数之结果</p>
<p> <img src="https://raw.githubusercontent.com/dnimo/img/master/%E4%BA%86%E8%A7%A3N-Gram%E6%A8%A1%E5%9E%8B/image-20201229183103524.png" alt="image-20201229183103524"></p>
<p>Ex：其中第一行，第二列表示给定前一个词是“i”时，当前词“want”的情况一共出现了827次，据此，我们便可以计算相应的频率分布表</p>
<p><img src="https://raw.githubusercontent.com/dnimo/img/master/%E4%BA%86%E8%A7%A3N-Gram%E6%A8%A1%E5%9E%8B/image-20201229183248740.png" alt="image-20201229183248740"></p>
<p>比如说，我们就以表中的$P(eat|i)=0.0036$ 这个概率值讲解，从表中得出”i“一共出现了2533次，而其后出现eat的次数一共有9次，$P(eat|i)=P(eat,i)\hspace{2cm}P(i)=count(eat,i)/count(i)=\frac{9}{2533}=0.0036$ </p>
<p>下面我们通过这个语料库进行判断：</p>
<ul>
<li>s1=“i want english food”</li>
<li>S2=”want i English food”</li>
</ul>
<p>首先判断p(s1)：$P(s1)=P(i|<s>)P(want|i)P(english|want)P((food|english)P(</s>|food)=0.000031$</p>
<p>$P(s2)=P(want|<s>)P(i|want)P(english|want)P(food|english)P(</s>|food)=0.00000002057$</p>
<p>通过比较我们发现s1更合理，以上就是二元模型</p>

    </div>

    
        <hr class="fhr">
        <div id="vcomments"></div>
    
</div>
    <div class="footer" id="footer">
    <p>Copyright © 2020 <a class="flink" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>-<a class="flink" target="_blank" rel="noopener" href="https://github.com/sanjinhub/hexo-theme-geek">Geek</a>.
        <label class="el-switch el-switch-green el-switch-sm" style="vertical-align: sub;">
            <input type="checkbox" name="switch" id="update_style">
            <span class="el-switch-style"></span>
        </label>
<!--         <script type="text/javascript">
        var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");
        document.write(unescape("%3Cspan id='cnzz_stat_icon_1278548644'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D1278548644%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));
        </script> -->
    </p>
</div>
<input type="hidden" id="web_style" value="black">
<input type="hidden" id="valine_appid" value="MeWCTePGu9T30hF9ddgxhFos-gzGzoHsz">
<input type="hidden" id="valine_appKey" value="xMcQwnxYVyT5UqgWzMOqVBPz">

<script src="/libs/jquery.min.js"></script>


<script src="/libs/highlight/highlight.pack.js"></script>

<script src='//cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>

<script src="/js/js.js"></script>

<style type="text/css">
.v * {
    color: #698fca;
}

.v .vlist .vcard .vhead .vsys {
    color: #3a3e4a;
}

.v .vlist .vcard .vh .vmeta .vat {
    color: #638fd5;
}

.v .vlist .vcard .vhead .vnick {
    color: #6ba1ff;
}

.v a {
    color: #8696b1;
}

.v .vlist .vcard .vhead .vnick:hover {
    color: #669bfc;
}
</style>
</body>

</html>